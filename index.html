<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2026 æ„›çš„å®ˆå€™èˆ‡ä¿®å¾© | 2æœˆäº’å‹•æ—¥æ›†</title>
    
    <meta property="og:title" content="2026 æ„›çš„å®ˆå€™èˆ‡ä¿®å¾© | 2æœˆäº’å‹•æ—¥æ›†">
    <meta property="og:description" content="äºŒæœˆä»½çš„æº«æŸ”ç·´ç¿’ã€‚åœ¨å®ˆå€™ä¸­å­¸æœƒå®‰é “ï¼Œåœ¨ä¿®å¾©ä¸­æ‰¾å›é€£çµã€‚">
    <meta property="og:image" content="https://images.unsplash.com/photo-1518199266791-5375a83190b7?q=80&w=2670&auto=format&fit=crop">
    <meta property="og:type" content="website">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Noto+Serif+TC:wght@500;700&family=Dancing+Script:wght@500;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* åŸºç¤è¨­å®š */
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #fdfbf7; color: #4a4a4a; -webkit-font-smoothing: antialiased; -webkit-tap-highlight-color: transparent; }
        .serif { font-family: 'Noto Serif TC', serif; }
        .cursive { font-family: 'Dancing Script', cursive; }
        .text-balance { text-wrap: balance; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* å¡ç‰‡äº’å‹• */
        .card-hover { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        @media (hover: hover) {
            .card-hover:not(.is-locked):hover { transform: translateY(-5px); box-shadow: 0 15px 30px -5px rgba(0, 0, 0, 0.08); }
            .card-hover:not(.is-locked):hover .btn-reveal { transform: translateY(-1px); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        }
        .is-locked { filter: grayscale(100%); opacity: 0.6; cursor: not-allowed !important; }
        .is-locked .btn-reveal { background-color: transparent; border-color: #d6d3d1; color: #78716c; }

        /* é¡è‰²å®šç¾© */
        .text-inward { color: #eebebb; } 
        .text-outward { color: #88b3c8; } 
        .text-weekend { color: #d4a373; } 
        
        /* æ–°æ˜¥ç‰¹åˆ¥æ¨£å¼ (æ·±ç´…æ¼¸å±¤ + é‡‘è‰²é»ç¶´) */
        .cny-card { 
            border: 1px solid #991b1b; 
            background: linear-gradient(135deg, #b91c1c 0%, #7f1d1d 100%); 
            box-shadow: 0 4px 6px -1px rgba(185, 28, 28, 0.3);
        }
        .text-cny { color: #fca5a5; } /* æ·ºç´…æ–‡å­— */
        
        /* æƒ…äººç¯€æ¨£å¼ */
        .text-valentine { color: #ec4899; } 
        .valentine-card { border: 1px solid #fbcfe8; background: linear-gradient(135deg, #fff5f9 0%, #fce7f3 100%); }
        
        /* å…¶ä»–å¡ç‰‡æ¨£å¼ */
        .special-pink-card { background-color: #fff0f0; border: 1px solid #eebebb; }
        .inward-card { background-color: white; border: 1px solid #fcede8; }
        .outward-card { background-color: white; border: 1px solid #eef6f9; }
        .weekend-card { background: linear-gradient(135deg, #fff9f0 0%, #fff0e0 100%); border: 1px solid #faeadd; }
        
        .btn-reveal { transition: all 0.3s ease; }
        
        /* æ›¸æ¶èˆ‡æ›¸ç± (ç¶­æŒåŸæ¨£) */
        .book-container { perspective: 1000px; }
        .book-cover { box-shadow: inset 4px 0 10px rgba(0,0,0,0.1), 2px 5px 15px rgba(0,0,0,0.15), 1px 1px 3px rgba(0,0,0,0.1); transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1); transform-origin: bottom center; background-color: #f0eee9; position: relative; z-index: 10; }
        .book-item:hover .book-cover { transform: translateY(-8px) scale(1.02); box-shadow: 4px 15px 25px rgba(0,0,0,0.2); }
        .book-item.checked .book-cover { filter: grayscale(100%) sepia(20%) contrast(90%); transform: translateY(0); }
        .book-cover img { opacity: 0; transition: opacity 0.5s ease; }
        .book-cover img.loaded { opacity: 1; }
        .book-link-btn { transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); opacity: 0.9; position: relative; z-index: 50; cursor: pointer; display: inline-flex; pointer-events: auto; }
        .book-link-btn:hover { opacity: 1; transform: translateY(-1px); }
        .read-stamp { position: absolute; top: 50%; left: 50%; width: 90px; height: 90px; border: 3px solid #d64040; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #d64040; background-color: rgba(255, 253, 245, 0.95); box-shadow: 0 4px 12px rgba(0,0,0,0.2); opacity: 0; transform: translate(-50%, -50%) scale(2); pointer-events: none; z-index: 20; mask-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.5'/%3E%3C/svg%3E"); -webkit-mask-image: linear-gradient(black, black); }
        .read-stamp::before { content: ''; position: absolute; inset: 3px; border: 1px solid #d64040; border-radius: 50%; }
        .book-item.checked .read-stamp { animation: stamp-slam 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
        @keyframes stamp-slam { 0% { opacity: 0; transform: translate(-50%, -50%) scale(3) rotate(-15deg); } 50% { opacity: 1; transform: translate(-50%, -50%) scale(0.9) rotate(-5deg); } 70% { transform: translate(-50%, -50%) scale(1.05) rotate(-5deg); } 100% { opacity: 0.95; transform: translate(-50%, -50%) scale(1) rotate(-5deg); } }
        
        .shelf-line { height: 12px; background: #e7e5e4; border-top: 1px solid #d6d3d1; border-bottom: 2px solid #d6d3d1; border-radius: 2px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        
        /* å‹•ç•« */
        @keyframes twinkle-strong { 0%, 100% { opacity: 0.3; transform: scale(0.8) rotate(0deg); filter: brightness(1); } 50% { opacity: 1; transform: scale(1.4) rotate(15deg); filter: brightness(1.5) drop-shadow(0 0 4px rgba(251, 191, 36, 0.9)); } }
        .animate-twinkle { animation: twinkle-strong 2s infinite ease-in-out; color: #fbbf24; }
        
        @keyframes heart-float-up { 0% { transform: translateY(20px) scale(0.4) rotate(0deg); opacity: 0; } 10% { opacity: 0.8; } 50% { transform: translateY(-80px) scale(1) rotate(5deg); } 100% { transform: translateY(-180px) scale(0.8) rotate(-5deg); opacity: 0; } }
        .heart-particle { position: absolute; bottom: -10px; color: #ec4899; opacity: 0; pointer-events: none; animation: heart-float-up 4s infinite linear; z-index: 0; filter: drop-shadow(0 2px 3px rgba(236, 72, 153, 0.2)); }
        
        @keyframes title-shine { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .title-gradient { background: linear-gradient(90deg, #d4a373 0%, #e76f51 25%, #d4a373 50%, #e9c46a 75%, #d4a373 100%); background-size: 200% auto; color: transparent; -webkit-background-clip: text; background-clip: text; animation: title-shine 4s linear infinite; filter: drop-shadow(0 2px 2px rgba(212, 163, 115, 0.2)); }
        
        @keyframes float-bg { 0% { transform: translateY(0px) rotate(0deg); } 50% { transform: translateY(-10px) rotate(3deg); } 100% { transform: translateY(0px) rotate(0deg); } }
        .bg-float-icon { animation: float-bg 8s ease-in-out infinite; }
    </style>
</head>
<body class="min-h-screen relative pb-10">

    <!-- Header -->
    <header class="pt-12 pb-8 px-6 text-center max-w-4xl mx-auto relative overflow-hidden">
        <!-- è£é£¾åº•åœ– -->
        <div class="absolute inset-0 pointer-events-none opacity-25 z-0">
             <i data-lucide="heart" class="absolute top-10 left-6 w-10 h-10 text-pink-400 bg-float-icon" style="animation-delay: 0s;"></i>
             <i data-lucide="coins" class="absolute top-16 right-10 w-12 h-12 text-yellow-500 bg-float-icon" style="animation-delay: 2s;"></i>
             <i data-lucide="scroll-text" class="absolute bottom-5 left-16 w-14 h-14 text-red-400 bg-float-icon" style="animation-delay: 4s; transform: rotate(-10deg);"></i>
             <i data-lucide="party-popper" class="absolute top-4 left-1/2 w-8 h-8 text-red-500 bg-float-icon" style="animation-delay: 1s;"></i>
             <i data-lucide="flower" class="absolute bottom-10 right-20 w-10 h-10 text-rose-400 bg-float-icon" style="animation-delay: 3s;"></i>
        </div>

        <div class="relative z-10">
            <div class="inline-block p-2 px-4 rounded-full bg-stone-100/80 text-stone-500 text-xs tracking-[0.2em] mb-4 backdrop-blur-sm">FEB 1 - FEB 28</div>
            <h1 class="serif text-3xl md:text-5xl font-bold mb-4 tracking-wide leading-tight title-gradient">
                æ„›çš„å®ˆå€™èˆ‡ä¿®å¾©
            </h1>
            <p class="text-stone-600 text-sm md:text-base max-w-xl mx-auto leading-relaxed text-balance">
                äºŒæœˆçš„æº«æŸ”ç·´ç¿’ã€‚<br>åœ¨å®ˆå€™ä¸­å­¸æœƒå®‰é “ï¼Œåœ¨ä¿®å¾©ä¸­æ‰¾å›é€£çµã€‚<br>
                é¡˜é€™å€‹æœˆï¼Œæˆ‘å€‘éƒ½èƒ½æˆç‚ºå½¼æ­¤çš„æ­¸å±¬ã€‚
            </p>
            
            <div class="flex justify-center flex-wrap gap-4 mt-6 text-xs text-stone-500">
                <div class="flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-[#eebebb]"></div> å‘å…§è¦ºå¯Ÿ</div>
                <div class="flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-[#88b3c8]"></div> å‘å¤–é€£çµ</div>
                <div class="flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-[#b91c1c]"></div> æ–°æ˜¥åœ˜åœ“</div>
                <div class="flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-[#f2d0a9]"></div> é€±æœ«é›»å½±é™¢</div>
            </div>

            <!-- Removed Demo Mode Notice for Production -->
        </div>
    </header>

    <!-- Bookshelf Section -->
    <section class="max-w-4xl mx-auto px-4 mb-16 relative z-10">
        <div class="relative pt-6">
            <div class="flex items-center justify-center gap-4 mb-10">
                <span class="h-[1px] w-8 bg-stone-300"></span>
                <div class="flex items-center gap-2">
                    <i data-lucide="sparkle" class="w-5 h-5 animate-twinkle"></i>
                    <h3 class="serif text-lg text-stone-600 font-bold tracking-[0.2em] uppercase">äºŒæœˆé–±è®€é¸æ›¸</h3>
                    <i data-lucide="sparkle" class="w-5 h-5 animate-twinkle" style="animation-delay: 1s;"></i>
                </div>
                <span class="h-[1px] w-8 bg-stone-300"></span>
            </div>
            <div id="book-shelf-container" class="grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-10 px-4 md:px-8"></div>
            <div class="shelf-line mt-0 w-full mx-auto max-w-4xl"></div>
        </div>
    </section>

    <!-- Grid Container -->
    <main class="max-w-6xl mx-auto px-4 pb-20 relative z-10">
        <div id="calendar-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6"></div>
    </main>

    <!-- Modal Overlay -->
    <div id="modal-overlay" class="fixed inset-0 bg-stone-900/60 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4 transition-opacity duration-300 opacity-0" onclick="closeModal()">
        <div id="modal-content" class="bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto no-scrollbar relative transform transition-all duration-300 scale-95 opacity-0 flex flex-col" onclick="event.stopPropagation()">
            <button onclick="closeModal()" class="absolute top-4 right-4 p-3 rounded-full bg-white/70 hover:bg-stone-100 text-stone-500 hover:text-stone-800 transition-colors z-20 backdrop-blur-sm shadow-sm"><i data-lucide="x" class="w-6 h-6"></i></button>
            <div id="modal-body"></div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-8 text-stone-300 text-xs relative z-10"><p>Â© 2026 æ„›çš„æ±ºå®šå­¸ @belovedroad.tw</p></footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- æ ¸å¿ƒé‚è¼¯ï¼šæ—¥æœŸé–å®š (æ­£å¼ç‰ˆ) ---
            // âš ï¸ DEBUG_MODE å·²é—œé–‰ï¼šç¾åœ¨æœƒæ ¹æ“šçœŸå¯¦æ—¥æœŸé–å®šå¡ç‰‡
            const DEBUG_MODE = false; 
            
            const currentYear = 2026;
            // ç²å–ç•¶å‰çœŸå¯¦æ—¥æœŸ
            const today = new Date();

            const isCardUnlocked = (dateStr) => {
                if(DEBUG_MODE) return true;

                const [month, day] = dateStr.split('/').map(Number);
                const cardDate = new Date(currentYear, month - 1, day);
                // ç‚ºäº†æ¯”è¼ƒåªä¿ç•™æ—¥æœŸéƒ¨åˆ†ï¼Œå¿½ç•¥æ™‚é–“
                const todayNormalized = new Date(today.getFullYear(), today.getMonth(), today.getDate());
                
                // å¦‚æœç¾åœ¨å·²ç¶“æ˜¯3æœˆä»¥å¾Œï¼Œ2æœˆå…¨éƒ¨è§£é–
                if (todayNormalized.getMonth() > 1) return true; 
                // å¦‚æœç¾åœ¨æ˜¯1æœˆï¼Œ2æœˆå…¨éƒ¨é–å®š
                if (todayNormalized.getMonth() < 1) return false;

                // åŒæ¨£æ˜¯2æœˆï¼Œæª¢æŸ¥æ—¥æœŸ
                return todayNormalized >= cardDate;
            };

            const isToday = (dateStr) => {
                const [month, day] = dateStr.split('/').map(Number);
                const todayNormalized = new Date(today.getFullYear(), today.getMonth(), today.getDate());
                return (todayNormalized.getMonth() + 1) === month && todayNormalized.getDate() === day;
            };

            const listIcons = { inward: 'heart', outward: 'globe', weekend: 'film' };
            const typeLabels = { inward: 'å‘å…§è¦ºå¯Ÿ', outward: 'å‘å¤–é€£çµ', weekend: 'é€±æœ«å½±é™¢' };

            // --- æ›¸å–®è³‡æ–™ ---
            const recommendedBooks = [
                { id: 'feb_b1', title: 'æ„›çš„è—è¡“', author: 'åŸƒé‡Œå¸Œï¼ä½›æ´›å§†', google_id: 'FDFiEAAAQBAJ', link: 'https://play.google.com/store/books/details/%E5%9F%83%E9%87%8C%E5%B8%8C_%E4%BD%9B%E6%B4%9B%E5%A7%86_%E6%84%9B%E7%9A%84%E8%97%9D%E8%A1%93_%E5%8F%B2%E4%B8%8A%E6%9C%80%E6%9A%A2%E9%8A%B7%E5%BF%83%E7%90%86%E5%AD%B8%E4%B8%8D%E6%9C%BD%E7%B6%93%E5%85%B8%E4%B8%96%E7%B4%80%E6%96%B0%E8%AD%AF%E6%9C%AC?id=FDFiEAAAQBAJ&hl=zh_TW' },
                { id: 'feb_b2', title: 'è®“æ„›å»¶çºŒçš„ä¸ƒå€‹æ–¹æ³•', author: 'ç´„ç¿°ï¼é«˜æ›¼', google_id: '2lD9EAAAQBAJ', link: 'https://play.google.com/store/books/details/%E7%B4%84%E7%BF%B0_%E9%AB%98%E6%9B%BC_%E5%A6%AE%E5%AE%89_%E5%B8%8C%E7%B6%AD%E7%88%BE_%E8%AE%93%E6%84%9B%E5%BB%B6%E7%BA%8C%E7%9A%84%E4%B8%83%E5%80%8B%E6%96%B9%E6%B3%95_%E5%85%A9%E5%80%8B%E4%BA%BA%E5%B9%B8%E7%A6%8F%E9%81%8E%E4%B8%80%E7%94%9F%E7%9A%84%E9%97%9C%E9%8D%B5%E7%A7%98%E8%A8%A3_%E6%96%B0%E4%BF%AE%E7%89%88?id=2lD9EAAAQBAJ&hl=zh_TW' },
                { id: 'feb_b3', title: 'æˆ‘å€‘ï¼Œä¸€èµ·ç·´æ„›', author: 'æ³°å€«æ–¯ï¼ç‘çˆ¾', google_id: 'rr1AEQAAQBAJ', link: 'https://play.google.com/store/books/details/%E6%B3%B0%E5%80%AB%E6%96%AF_%E7%91%9E%E7%88%BE_%E6%88%91%E5%80%91_%E4%B8%80%E8%B5%B7%E7%B7%B4%E6%84%9B?id=rr1AEQAAQBAJ&hl=zh_TW' },
                { id: 'feb_b4', title: 'é—œä¿‚ä¿®å¾©åŠ›', author: 'è‰¾å¾·ï¼æ¥šå°¼å…‹ç­‰', google_id: 'EBdDEAAAQBAJ', link: 'https://play.google.com/store/books/details/%E8%89%BE%E5%BE%B7_%E6%A5%9A%E5%B0%BC%E5%85%8B_%E5%85%8B%E5%8B%9E%E8%92%82%E4%BA%9E_%E9%AB%98%E5%BE%B7_%E9%97%9C%E4%BF%82%E4%BF%AE%E5%BE%A9%E5%8A%9B_%E5%BF%83%E7%90%86%E5%AD%B8%E5%A4%A7%E5%B8%AB%E6%95%99%E4%BD%A0%E5%BE%9E%E8%A1%9D%E7%AA%81_%E8%A3%82%E7%97%95%E4%B8%AD%E5%9F%B9%E9%A4%8A%E6%9B%B4%E9%AB%98%E7%9A%84%E9%81%A9%E6%87%89%E5%8A%9B_%E9%87%8D%E6%8B%BE%E4%BA%BA%E8%88%87%E4%BA%BA%E7%9A%84?id=EBdDEAAAQBAJ&hl=zh_TW' },
            ];

            function loadBookCover(imgElement, book) {
                let initialUrl = book.google_id ? `https://books.google.com/books/content?id=${book.google_id}&printsec=frontcover&img=1&zoom=1` : `https://covers.openlibrary.org/b/isbn/${book.isbn_en}-L.jpg`;
                const textPlaceholderUrl = `https://placehold.co/400x600/f5f5f4/a8a29e?text=${encodeURIComponent(book.title.substring(0,10))}`;
                imgElement.src = initialUrl;
                imgElement.onload = function() { if (this.naturalWidth < 5) this.src = textPlaceholderUrl; else this.classList.add('loaded'); };
                imgElement.onerror = function() { this.src = textPlaceholderUrl; };
            }

            function renderBookShelf() {
                const container = document.getElementById('book-shelf-container');
                const savedState = JSON.parse(localStorage.getItem('loveCalendarFebBooks')) || {}; 
                if (!container) return;
                container.innerHTML = recommendedBooks.map(book => {
                    const isChecked = savedState[book.id] ? 'checked' : '';
                    return `
                        <div class="book-item ${isChecked} flex flex-col items-center group relative">
                            <div class="cursor-pointer w-full flex flex-col items-center" onclick="window.toggleBook('${book.id}')">
                                <div class="relative w-full aspect-[2/3] mb-3 book-cover rounded-sm overflow-hidden bg-stone-200">
                                    <img id="cover-${book.id}" alt="${book.title}" class="w-full h-full object-cover">
                                    <div class="read-stamp">
                                        <span class="font-serif font-bold text-lg tracking-widest border-b-2 border-[#d64040] mb-1">è®€å®Œäº†</span>
                                        <span class="text-[8px] tracking-wider font-sans">æ­¡è¿åˆ†äº«å¿ƒå¾—</span>
                                    </div>
                                    <div class="absolute inset-0 bg-gradient-to-tr from-black/5 to-white/10 pointer-events-none"></div>
                                </div>
                                <h4 class="font-serif text-stone-700 font-bold text-sm md:text-base leading-tight mb-1 line-clamp-2 h-10 flex items-center justify-center text-center px-1">${book.title}</h4>
                                <p class="text-[10px] uppercase tracking-wider text-stone-400 font-sans mb-2">${book.author}</p>
                            </div>
                            <div class="mt-2 relative z-50">
                                <a href="${book.link}" target="_blank" rel="noopener noreferrer" onclick="event.stopImmediatePropagation();" class="book-link-btn inline-flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium tracking-wide border border-stone-200 text-stone-600 bg-white/60 hover:bg-white hover:border-[#d4a373] hover:text-[#d4a373] hover:shadow-sm transition-all"><i data-lucide="book-open" class="w-3.5 h-3.5"></i>ä¸­æ–‡ç‰ˆè³‡è¨Š</a>
                            </div>
                        </div>
                    `;
                }).join('');
                recommendedBooks.forEach(book => { const img = document.getElementById(`cover-${book.id}`); if(img) loadBookCover(img, book); });
                if(window.lucide) lucide.createIcons();
            }

            window.toggleBook = function(bookId) {
                const savedState = JSON.parse(localStorage.getItem('loveCalendarFebBooks')) || {};
                if (savedState[bookId]) delete savedState[bookId]; else { savedState[bookId] = true; if (navigator.vibrate) navigator.vibrate(20); }
                localStorage.setItem('loveCalendarFebBooks', JSON.stringify(savedState));
                renderBookShelf();
            }

            window.copyPageUrl = function(buttonElement, index) {
                const item = calendarData[index];
                const textToCopy = `ã€${item.date} æ„›çš„å®ˆå€™èˆ‡ä¿®å¾©ã€‘\n\nâ ${item.quote.replace(/<br>/g, '\n')} â\n\nâš¡ ä»Šæ—¥ç·´ç¿’ï¼š\n${item.action}\n\nğŸ’­ è¦ºå¯Ÿæ™‚åˆ»ï¼š\n${item.reflection}\n\n#æ„›çš„æ±ºå®šå­¸æ¯æ—¥ç‚ºæ„›ç·´ç¿’`;

                // å®šç¾©æˆåŠŸå›é¥‹çš„ UI å‡½å¼
                const showSuccessFeedback = () => {
                    const originalContent = buttonElement.innerHTML;
                    const originalClass = buttonElement.className;
                    buttonElement.className = "w-full py-3 text-sm font-bold tracking-wide text-green-700 bg-green-100 border border-green-200 rounded-lg transition-all flex items-center justify-center gap-2 mt-2";
                    buttonElement.innerHTML = `<i data-lucide="check" class="w-4 h-4"></i> âœ… ä»Šæ—¥å…§å®¹å·²è¤‡è£½ï¼å¿«å»ç¤¾ç¾¤åˆ†äº«ç·´ç¿’å¿ƒå¾—å§`;
                    if(window.lucide) lucide.createIcons();
                    setTimeout(() => { 
                        buttonElement.className = originalClass; 
                        buttonElement.innerHTML = originalContent; 
                        if(window.lucide) lucide.createIcons(); 
                    }, 2000);
                };

                // Fallback: ä½¿ç”¨ textarea èˆ‡ execCommand ('copy') - ç”¨æ–¼ç•¶ Clipboard API è¢«å°é–æ™‚
                const fallbackCopyTextToClipboard = (text) => {
                    const textArea = document.createElement("textarea");
                    textArea.value = text;
                    
                    // é¿å…é é¢æ»¾å‹•
                    textArea.style.top = "0";
                    textArea.style.left = "0";
                    textArea.style.position = "fixed";
                    textArea.style.opacity = "0";
                
                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();
                
                    try {
                        const successful = document.execCommand('copy');
                        if (successful) {
                            showSuccessFeedback();
                        } else {
                            console.error('Fallback: è¤‡è£½æŒ‡ä»¤å¤±æ•—');
                        }
                    } catch (err) {
                        console.error('Fallback: ç„¡æ³•è¤‡è£½', err);
                    }
                
                    document.body.removeChild(textArea);
                };

                // å„ªå…ˆå˜—è©¦ç¾ä»£ APIï¼Œå¤±æ•—å¾Œä½¿ç”¨ Fallback
                if (!navigator.clipboard) {
                    fallbackCopyTextToClipboard(textToCopy);
                    return;
                }
                
                navigator.clipboard.writeText(textToCopy).then(() => {
                    showSuccessFeedback();
                }).catch(err => {
                    console.warn('Clipboard API æ¬Šé™è¢«æ‹’ï¼Œå˜—è©¦ä½¿ç”¨ Fallback æ–¹æ³•:', err);
                    fallbackCopyTextToClipboard(textToCopy);
                });
            }

            window.closeModal = function() {
                const overlay = document.getElementById('modal-overlay');
                const modalContent = document.getElementById('modal-content');
                overlay.classList.add('opacity-0'); modalContent.classList.remove('scale-100'); modalContent.classList.add('scale-95', 'opacity-0');
                setTimeout(() => { overlay.classList.add('hidden'); document.body.style.overflow = ''; }, 300);
            }
            document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });
            renderBookShelf();

            // --- æ—¥æ›†è³‡æ–™ ---
            const calendarData = [
                // ç¬¬ä¸€é€±ï¼šæ„›çš„æš–èº«
                { date: "2/1", day: "(æ—¥)", type: "inward", icon: "sun", quote: "ç­‰å¾…ä¸æ˜¯ç©ºç™½ï¼Œ<br>è€Œæ˜¯ç‚ºå¿ƒé¨°å‡ºç©ºé–“ã€‚", action: "æ—©æ™¨èµ·åºŠå¾Œï¼ŒèŠ± 3 åˆ†é˜ååœ¨åºŠé‚Šæ·±å‘¼å¸ï¼Œä»€éº¼éƒ½ä¸åšã€‚", reflection: "åœ¨å®‰éœçš„ç‰‡åˆ»è£¡ï¼Œæˆ‘è½è¦‹äº†å¿ƒè£¡çš„ä»€éº¼è²éŸ³ï¼Ÿ" },
                { date: "2/2", day: "(ä¸€)", type: "inward", icon: "coffee", quote: "æ„›è‡ªå·±ï¼Œ<br>æ˜¯é–‹å§‹ä¸€æ®µçµ‚èº«æµªæ¼«ã€‚", action: "ç‚ºè‡ªå·±æº–å‚™ä¸€ä»½ç‰¹åˆ¥çš„æ—©é¤ï¼Œä¸¦æ…¢æ…¢äº«ç”¨ã€‚", reflection: "ç•¶æˆ‘æ…é‡å°å¾…è‡ªå·±æ™‚ï¼Œæ„Ÿè¦ºå¦‚ä½•ï¼Ÿ" },
                { date: "2/3", day: "(äºŒ)", type: "inward", icon: "book-heart", quote: "æ¥ç´ä½ çš„é™°å½±ï¼Œ<br>å…‰æ‰é€²å¾—ä¾†ã€‚", action: "å¯«ä¸‹ä¸€å€‹ä½ è¦ºå¾—è‡ªå·±ã€Œä¸å¤ å¥½ã€çš„åœ°æ–¹ï¼Œå°å®ƒèªªï¼šã€Œæˆ‘çœ‹è¦‹ä½ äº†ï¼Œæ²’é—œä¿‚ã€‚ã€", reflection: "æ‰¿èªè„†å¼±ï¼Œæœƒè®“æˆ‘è®Šå¼±ï¼Œé‚„æ˜¯è®Šå¼·ï¼Ÿ" },
                { date: "2/4", day: "(ä¸‰)", type: "outward", icon: "smile", quote: "å¾®ç¬‘æ˜¯å…©å€‹äººä¹‹é–“<br>æœ€çŸ­çš„è·é›¢ã€‚", action: "å°ä¸€å€‹ä¸ç†Ÿè­˜çš„åŒäº‹æˆ–é„°å±…å¾®ç¬‘é»é ­ã€‚", reflection: "é‡‹å‡ºå–„æ„å¾Œï¼Œæˆ‘æ„Ÿåˆ°äº†ä»€éº¼ï¼Ÿ" },
                { date: "2/5", day: "(å››)", type: "outward", icon: "hand-heart", quote: "çµ¦äºˆï¼Œ<br>æ˜¯ç‚ºäº†è®“æ„›æµå‹•ã€‚", action: "ä¸»å‹•è©¢å•ä¸€ä½æœ‹å‹ï¼šã€Œæœ€è¿‘æœ‰ä»€éº¼æˆ‘å¯ä»¥å¹«ä½ çš„å—ï¼Ÿã€", reflection: "æˆç‚ºä»–äººçš„æ”¯æŒï¼Œå¸¶çµ¦æˆ‘ä»€éº¼åŠ›é‡ï¼Ÿ" },
                { date: "2/6", day: "(äº”)", type: "outward", icon: "message-circle", quote: "çœŸæ­£çš„é€£çµï¼Œ<br>å§‹æ–¼çœŸèª çš„åˆ†äº«ã€‚", action: "åˆ†äº«ä¸€ä»¶æœ€è¿‘è®“ä½ æ„Ÿå‹•çš„å°äº‹çµ¦æœ‹å‹ã€‚", reflection: "åˆ†äº«å¿«æ¨‚ï¼Œæ˜¯å¦è®“å¿«æ¨‚åŠ å€äº†ï¼Ÿ" },
                { date: "2/7", day: "(å…­)", type: "weekend", icon: "film", quote: "åœ¨éŒ¯éèˆ‡é‡é€¢ä¹‹é–“ï¼Œ<br>æˆ‘å€‘å­¸æœƒäº†æ„›ã€‚", action: "çœ‹ä¸€éƒ¨é—œæ–¼ã€ŒéŒ¯éèˆ‡é‡é€¢ã€çš„é›»å½±ï¼Œå…è¨±è‡ªå·±æµæ·šã€‚", reflection: "å¦‚æœæ„›æœ‰éºæ†¾ï¼Œé‚£æ•™æœƒäº†æˆ‘ä»€éº¼ï¼Ÿ", movie: "ã€Šä¹‹å‰çš„æˆ‘å€‘ã€‹", movieDesc: "å› ç·£éš›æœƒï¼Œè·¨è¶Šæ™‚ç©ºçš„æ·±æƒ…å‡è¦–" },

                // ç¬¬äºŒé€±ï¼šæ„›çš„è¡¨é”
                { date: "2/8", day: "(æ—¥)", type: "inward", icon: "heart-handshake", quote: "å‹‡æ°£ä¸æ˜¯ä¸å®³æ€•ï¼Œ<br>è€Œæ˜¯å¸¶è‘—ææ‡¼å‰è¡Œã€‚", action: "å¯«ä¸‹ä¸€å€‹ä½ ä¸€ç›´ä¸æ•¢è¡¨é”çš„æ„Ÿå—ã€‚", reflection: "å¦‚æœèªªå‡ºä¾†å¾Œæœæ²’é‚£éº¼ç³Ÿï¼Œæˆ‘æœƒæ€éº¼åšï¼Ÿ" },
                { date: "2/9", day: "(ä¸€)", type: "inward", icon: "pen", quote: "æ–‡å­—æœ‰æº«åº¦ï¼Œ<br>èƒ½èåŒ–å†°å°çš„å¿ƒã€‚", action: "å¯«ä¸€å°ä¿¡çµ¦æœªä¾†çš„è‡ªå·±ï¼Œå‘Šè¨´ä»–/å¥¹ï¼šã€Œä½ å€¼å¾—è¢«æ„›ã€‚ã€", reflection: "æœªä¾†çš„æˆ‘ï¼Œæœƒç”¨ä»€éº¼è¡¨æƒ…è®€é€™å°ä¿¡ï¼Ÿ" },
                { date: "2/10", day: "(äºŒ)", type: "inward", icon: "gift", quote: "é©šå–œï¼Œ<br>æ˜¯å¹³å‡¡æ—¥å­è£¡çš„ç³–ã€‚", action: "å·å·æº–å‚™ä¸€å€‹å°ç¦®ç‰©ï¼ˆå³ä½¿æ˜¯ä¸€é¡†ç³–æœï¼‰çµ¦åœ¨æ„çš„äººã€‚", reflection: "æƒ³åƒå°æ–¹æ”¶åˆ°æ™‚çš„ç¬‘å®¹ï¼Œæˆ‘å¿ƒæƒ…å¦‚ä½•ï¼Ÿ" },
                { date: "2/11", day: "(ä¸‰)", type: "outward", icon: "phone", quote: "è²éŸ³çš„æ“æŠ±ï¼Œ<br>æ¯”æ–‡å­—æ›´çœŸå¯¦ã€‚", action: "æ‰“é›»è©±çµ¦ä¸€ä½è¨±ä¹…æœªè¦‹çš„æœ‹å‹ï¼Œåªç‚ºäº†è½è½ä»–çš„è²éŸ³ã€‚", reflection: "è½è¦‹ç†Ÿæ‚‰çš„è²éŸ³ï¼Œå–šé†’äº†ä»€éº¼å›æ†¶ï¼Ÿ" },
                { date: "2/12", day: "(å››)", type: "outward", icon: "users", quote: "è®šç¾ï¼Œ<br>æ˜¯çœ‹è¦‹å°æ–¹çš„å…‰ã€‚", action: "å…¬é–‹è®šç¾ä¸€ä½å¤¥ä¼´çš„å„ªé»ï¼Œè®“ä»–çŸ¥é“ä½ å¾ˆæ¬£è³ä»–ã€‚", reflection: "è¢«è‚¯å®šçš„ä»–ï¼Œçœ¼ç¥æœ‰ä»€éº¼è®ŠåŒ–ï¼Ÿ" },
                { date: "2/13", day: "(äº”)", type: "outward", icon: "music", quote: "æ„›å¦‚æ¨‚ç« ï¼Œ<br>éœ€è¦å…±é³´ã€‚", action: "åˆ†äº«ä¸€é¦–ä»£è¡¨ä½ ç¾åœ¨å¿ƒå¢ƒçš„æƒ…æ­Œçµ¦å¦ä¸€åŠæˆ–å¥½å‹ã€‚", reflection: "éŸ³æ¨‚æ›¿æˆ‘èªªå‡ºäº†å“ªäº›èªªä¸å‡ºå£çš„è©±ï¼Ÿ" },
                { date: "2/14", day: "(å…­)", type: "weekend", icon: "heart", quote: "æ„›åœ¨é»æ˜ç ´æ›‰å‰ï¼Œ<br>ä¹Ÿåœ¨æ—¥è½é»ƒæ˜å¾Œã€‚", action: "ã€æƒ…äººç¯€ç‰¹è¼¯ã€‘èˆ‡æ„›äººï¼ˆæˆ–è‡ªå·±ï¼‰ä¾†ä¸€å ´ä¸çœ‹æ‰‹æ©Ÿçš„ç´„æœƒã€‚", reflection: "ç•¶æˆ‘å€‘å…¨å¿ƒå…¨æ„åœ¨ä¸€èµ·ï¼Œæ™‚é–“æ˜¯å¦è®Šæ…¢äº†ï¼Ÿ", movie: "ã€Šæ„›åœ¨é»æ˜ç ´æ›‰æ™‚ã€‹", movieDesc: "åœ¨å°è©±ä¸­çœ‹è¦‹éˆé­‚çš„å…±æŒ¯" },

                // ç¬¬ä¸‰é€±ï¼šæ„›çš„åœ˜åœ“ (CNY Special)
                { date: "2/15", day: "(æ—¥)", type: "inward", icon: "home", quote: "å®¶ï¼Œ<br>æ˜¯å¿ƒä¹‹æ‰€å‘ã€‚", action: "æ•´ç†æˆ¿é–“çš„ä¸€å€‹è§’è½ï¼Œç‚ºè¿æ¥æ–°å¹´åšæº–å‚™ã€‚", reflection: "å¤–åœ¨çš„æ•´æ½”ï¼Œå¦‚ä½•å½±éŸ¿æˆ‘çš„å…§åœ¨ï¼Ÿ" },
                { date: "2/16", day: "(ä¸€)", type: "inward", icon: "utensils", quote: "åœ˜åœ“é£¯çš„å‘³é“ï¼Œ<br>æ˜¯æ„›çš„è¨˜æ†¶ã€‚", action: "ã€é™¤å¤•ã€‘åœ¨é¤æ¡Œä¸Šï¼Œä¸»å‹•å¤¾èœçµ¦é•·è¼©ï¼Œä¸¦èªªè²è¬è¬ã€‚", reflection: "é€™ä¸€é “é£¯ï¼Œå‡èšäº†å¤šå°‘æ­²æœˆçš„æ©æƒ…ï¼Ÿ" },
                { date: "2/17", day: "(äºŒ)", type: "inward", icon: "sparkles", quote: "æ–°çš„ä¸€å¹´ï¼Œ<br>å¾ç¥ç¦é–‹å§‹ã€‚", action: "ã€åˆä¸€ã€‘å°é¡ä¸­çš„è‡ªå·±èªªä¸‰å¥å‰ç¥¥è©±ã€‚", reflection: "æˆ‘å°æ–°çš„ä¸€å¹´ï¼Œæœ‰ä»€éº¼ç¾å¥½çš„ç›¼æœ›ï¼Ÿ" },
                { date: "2/18", day: "(ä¸‰)", type: "outward", icon: "user-plus", quote: "è¦ªæˆšæˆ–è¨±å˜®å¨ï¼Œ<br>ä½†é—œå¿ƒæ˜¯çœŸå¯¦çš„ã€‚", action: "ã€åˆäºŒã€‘è©¦è‘—ç”¨å¥½å¥‡å¿ƒå»è½é•·è¼©çš„é‡è¤‡æ•…äº‹ï¼Œä¸æ‰“æ–·ã€‚", reflection: "ç•¶æˆ‘æ”¾ä¸‹è©•åˆ¤ï¼Œçœ‹è¦‹äº†ä»€éº¼ï¼Ÿ" },
                { date: "2/19", day: "(å››)", type: "outward", icon: "laugh", quote: "ç¬‘è²ï¼Œ<br>æ˜¯æœ€å¥½çš„ç™‚ç™’ã€‚", action: "ã€åˆä¸‰ã€‘åœ¨èšæœƒä¸­è¬›ä¸€å€‹ç¬‘è©±ï¼Œæˆ–è€…é–‹å¿ƒåœ°å¤§ç¬‘ã€‚", reflection: "å¿«æ¨‚çš„æ„ŸæŸ“åŠ›æœ‰å¤šå¼·ï¼Ÿ" },
                { date: "2/20", day: "(äº”)", type: "outward", icon: "map-pin", quote: "èµ°å‡ºå»ï¼Œ<br>çœ‹è¦‹ä¸åŒçš„é¢¨æ™¯ã€‚", action: "ã€åˆå››ã€‘å»ä¸€å€‹æ²’å»éçš„å…¬åœ’æˆ–è¡—é“æ•£æ­¥ã€‚", reflection: "æ–°é®®æ„Ÿå¸¶çµ¦æˆ‘ä»€éº¼å•Ÿç™¼ï¼Ÿ" },
                { date: "2/21", day: "(å…­)", type: "weekend", icon: "infinity", quote: "å³ä½¿å®‡å®™æ··äº‚ï¼Œ<br>æ„›èƒ½ç©¿è¶Šä¸€åˆ‡ã€‚", action: "ã€åˆäº”ã€‘æ“æŠ±èº«é‚Šçš„å®¶äººï¼Œä¹…ä¸€é»ï¼Œæ·±ä¸€é»ã€‚", reflection: "åœ¨é€™å€‹æ··äº‚çš„ä¸–ç•Œï¼Œèª°æ˜¯æˆ‘çš„å®šæµ·ç¥é‡ï¼Ÿ", movie: "ã€Šåª½çš„å¤šé‡å®‡å®™ã€‹", movieDesc: "ç©¿è¶Šå¤šé‡å®‡å®™ï¼Œåªç‚ºæ‰¾åˆ°ä½ " },

                // ç¬¬å››é€±ï¼šæ„›çš„ä¿®å¾©
                { date: "2/22", day: "(æ—¥)", type: "inward", icon: "battery-charging", quote: "ä¼‘æ¯ï¼Œ<br>æ˜¯ç‚ºäº†èµ°æ›´é•·çš„è·¯ã€‚", action: "çµ¦è‡ªå·±ä¸€å°æ™‚çš„ã€Œæ•¸ä½æ’æ¯’ã€ï¼Œé—œæ‰ç¶²è·¯ã€‚", reflection: "æ–·ç·šçš„æ™‚å€™ï¼Œæˆ‘èˆ‡è‡ªå·±é€£ç·šäº†å—ï¼Ÿ" },
                { date: "2/23", day: "(ä¸€)", type: "inward", icon: "bandage", quote: "å‚·å£æ˜¯å…‰é€²å…¥çš„åœ°æ–¹ã€‚", action: "å›æƒ³ä¸€å€‹éå¾€çš„æŒ«æŠ˜ï¼Œæ‰¾å‡ºå®ƒå¸¶çµ¦ä½ çš„ç¦®ç‰©ã€‚", reflection: "é‚£äº›æ®ºä¸æ­»æˆ‘çš„ï¼Œå¦‚ä½•è®“æˆ‘æ›´æº«æŸ”ï¼Ÿ" },
                { date: "2/24", day: "(äºŒ)", type: "inward", icon: "leaf", quote: "è®“éå»éå»ï¼Œ<br>è®“æœªä¾†åˆ°ä¾†ã€‚", action: "æ¸…ç†æ‰‹æ©Ÿè£¡ä¸å†éœ€è¦çš„ç…§ç‰‡æˆ–è¯çµ¡äººã€‚", reflection: "æ”¾æ‰‹ï¼Œæ˜¯ç‚ºäº†é¨°å‡ºé›™æ‰‹æ“æŠ±æ–°çš„å¯èƒ½ã€‚" },
                { date: "2/25", day: "(ä¸‰)", type: "outward", icon: "sun", quote: "åŸè«’ï¼Œ<br>æ˜¯æ”¾éè‡ªå·±ã€‚", action: "åœ¨å¿ƒè£¡åŸè«’ä¸€å€‹æ›¾ç¶“å†’çŠ¯ä½ çš„äººã€‚", reflection: "æ”¾ä¸‹æ€¨æ¨å¾Œï¼Œå¿ƒè£¡æ˜¯å¦è¼•ç›ˆäº†ä¸€äº›ï¼Ÿ" },
                { date: "2/26", day: "(å››)", type: "outward", icon: "droplet", quote: "æº«æŸ”ï¼Œ<br>æ˜¯æœ€å¼·å¤§çš„åŠ›é‡ã€‚", action: "å°ä¸€å€‹çŠ¯éŒ¯çš„äººï¼ˆæˆ–æ˜¯è‡ªå·±ï¼‰ï¼Œèªªè²ã€Œæ²’é—œä¿‚ã€ã€‚", reflection: "å¯¬å®¹ï¼Œå‰µé€ äº†ä»€éº¼æ¨£çš„ç©ºé–“ï¼Ÿ" },
                { date: "2/27", day: "(äº”)", type: "outward", icon: "anchor", quote: "æ„›æ˜¯æ†ä¹…å¿è€ï¼Œ<br>åˆæœ‰æ©æ…ˆã€‚", action: "å …æŒåšä¸€ä»¶å°ä»–äººæœ‰ç›Šçš„å°äº‹ï¼Œä¸æ±‚å›å ±ã€‚", reflection: "é»˜é»˜ä»˜å‡ºï¼Œå¸¶çµ¦æˆ‘ä»€éº¼æ¨£çš„æ»¿è¶³ï¼Ÿ" },
                { date: "2/28", day: "(å…­)", type: "weekend", icon: "cloud-sun", quote: "è‹¥æ˜¯å…©æƒ…ç›¸æ‚…ï¼Œ<br>ä½•é ˆæŠ¹å»è¨˜æ†¶ï¼Ÿ", action: "ã€æœˆçµ‚å„€å¼ã€‘æ•´ç†æœ¬æœˆçš„æ„Ÿæ©æ¸…å–®ã€‚", reflection: "æ„›éï¼Œç—›éï¼Œæ˜¯å¦ä¾ç„¶å€¼å¾—ï¼Ÿ", movie: "ã€Šç‹ç‰Œå†¤å®¶ã€‹", movieDesc: "åœ¨éºå¿˜çš„é‚Šç·£ï¼Œé‡æ–°æ„›ä¸Šä½ " },
            ];

            const grid = document.getElementById('calendar-grid');
            calendarData.forEach((item, index) => {
                const card = document.createElement('div');
                const unlocked = isCardUnlocked(item.date);
                const isTodayCard = isToday(item.date);
                const isValentines = item.date === "2/14";
                const isCNY = ["2/16", "2/17", "2/18", "2/19", "2/20", "2/21"].includes(item.date);
                
                let cardClass = "p-5 rounded-xl shadow-sm cursor-pointer card-hover relative h-48 flex flex-col justify-between group overflow-hidden border";
                if (unlocked) {
                    if(isValentines) cardClass += " valentine-card"; else if(isCNY) cardClass += " cny-card"; else if(item.type === 'weekend') cardClass += " weekend-card border-[#faeadd]"; else if (item.date === "2/11" || item.date === "2/25") cardClass += " special-pink-card"; else if (item.type === 'inward') cardClass += " inward-card border-[#fcede8]"; else cardClass += " outward-card border-[#eef6f9]";
                } else { cardClass += " bg-white border-stone-200 is-locked"; }

                let accentColor = "text-stone-300";
                if (unlocked) {
                    if(isValentines) accentColor = "text-valentine"; else if(isCNY) accentColor = "text-cny"; else if(item.type === 'inward') accentColor = "text-inward"; else if(item.type === 'outward') accentColor = "text-outward"; else if(item.type === 'weekend') accentColor = "text-[#d4a373]";
                }

                let btnText = "ç¿»é–‹çœ‹çœ‹", btnClass = "btn-reveal px-4 py-1.5 rounded-full text-[11px] font-medium tracking-wide border transition-all duration-300 relative z-10 bg-transparent";
                if (unlocked) {
                    if(isValentines) btnClass += " border-[#ec4899] text-[#ec4899]"; 
                    // CNY æŒ‰éˆ•ï¼šç™½åº•ç´…å­—
                    else if(isCNY) btnClass = "btn-reveal px-4 py-1.5 rounded-full text-[11px] font-medium tracking-wide bg-white text-[#b91c1c] border border-white hover:bg-stone-100 shadow-md"; 
                    else if(item.type === 'inward') btnClass += " border-[#eebebb] text-[#eebebb]"; 
                    else if(item.type === 'outward') btnClass += " border-[#88b3c8] text-[#88b3c8]"; 
                    else if(item.type === 'weekend') btnClass += " border-[#d4a373] text-[#d4a373]";
                } else { btnText = "å¾…è§£é–"; btnClass = "px-4 py-1.5 rounded-full text-[11px] font-medium tracking-wide border border-stone-300 text-stone-400 bg-transparent cursor-not-allowed"; }

                let headerColor = unlocked ? "text-stone-400 group-hover:text-stone-500" : "text-stone-300";
                let signatureColor = "text-stone-300";
                let titleColor = unlocked ? (item.type === 'weekend' ? "text-stone-700" : "text-stone-600") : "text-stone-400";

                // æ–°æ˜¥æ–‡å­—åç™½è¨­å®š
                if (unlocked && isCNY) {
                    headerColor = "text-red-100/90";
                    titleColor = "text-white";
                    accentColor = "text-yellow-300/90"; // é‡‘è‰²å‰¯æ¨™
                    signatureColor = "text-red-200/60";
                } else if(unlocked) { 
                    if(isValentines) signatureColor = "text-valentine"; else if(item.type === 'inward') signatureColor = "text-inward"; else if(item.type === 'outward') signatureColor = "text-outward"; else if(item.type === 'weekend') signatureColor = "text-[#d4a373]"; 
                }

                card.className = cardClass;
                if (unlocked) card.onclick = () => window.openModal(index);

                let specialEffectHtml = '';
                if (isTodayCard && isValentines) {
                    specialEffectHtml = `<div class="absolute inset-0 pointer-events-none overflow-hidden z-0"><i data-lucide="heart" class="w-6 h-6 heart-particle text-pink-400" style="left: 15%; animation-delay: 0s;"></i><i data-lucide="heart" class="w-4 h-4 heart-particle text-pink-300" style="left: 40%; animation-delay: 1.2s;"></i><i data-lucide="heart" class="w-7 h-7 heart-particle text-pink-500" style="left: 70%; animation-delay: 0.5s;"></i></div>`;
                }
                
                // æ–°æ˜¥è£é£¾ï¼šé‡‘å…ƒå¯¶èˆ‡å·è»¸
                if (unlocked && isCNY) {
                    specialEffectHtml = `
                        <div class="absolute -top-1 -right-1 opacity-25 pointer-events-none z-0">
                             <i data-lucide="coins" class="w-12 h-12 text-yellow-300 transform -rotate-12"></i>
                        </div>
                        <div class="absolute bottom-2 left-2 opacity-15 pointer-events-none z-0">
                             <i data-lucide="scroll" class="w-16 h-16 text-yellow-300 transform rotate-12"></i>
                        </div>
                    `;
                }

                card.innerHTML = `${specialEffectHtml}<div class="z-10 flex justify-between items-start"><span class="font-sans text-xs font-bold tracking-wider ${headerColor} transition-colors">${item.date} ${item.day}</span><i data-lucide="${unlocked ? listIcons[item.type] : 'lock'}" class="${accentColor} w-4 h-4 opacity-70"></i></div><div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none z-0 mt-2"><div class="text-center mb-5"><h3 class="font-serif text-lg font-bold ${titleColor} tracking-[0.2em] mb-0.5 text-balance">${isValentines ? "æ„›çš„ç‰¹åˆ¥ç·´ç¿’" : (isCNY ? "æ–°æ˜¥åœ˜åœ“ç·´ç¿’" : "æ¯æ—¥æ„›çš„ç·´ç¿’")}</h3><p class="cursive text-xl opacity-90 ${accentColor} font-medium tracking-wide">${isValentines ? "Be My Valentine" : (isCNY ? "Happy New Year" : "Love Practice")}</p></div><button class="${btnClass}">${btnText}</button></div><div class="z-10 flex justify-end items-end"><span class="text-[9px] font-medium tracking-wide opacity-50 ${signatureColor}">æ„›çš„æ±ºå®šå­¸ @belovedroad.tw</span></div>`;
                grid.appendChild(card);
            });
            
            window.openModal = function(index) {
                const item = calendarData[index];
                const modalBody = document.getElementById('modal-body');
                const overlay = document.getElementById('modal-overlay');
                const modalContent = document.getElementById('modal-content');
                const isCNY = ["2/16", "2/17", "2/18", "2/19", "2/20", "2/21"].includes(item.date);

                let accentClass = "text-stone-500";
                let bgClass = "bg-stone-50";
                
                if (isCNY) { 
                    accentClass = "text-[#b91c1c]"; // æ·±ç´…
                    bgClass = "bg-red-50"; 
                } else if(item.type === 'inward') { accentClass = "text-[#eebebb]"; bgClass = "bg-[#fdf2f2]"; }
                else if(item.type === 'outward') { accentClass = "text-[#88b3c8]"; bgClass = "bg-[#f0f7fa]"; }
                else if(item.type === 'weekend') { accentClass = "text-[#d4a373]"; bgClass = "bg-[#fff9f0]"; }
                if(item.date === "2/14") { accentClass = "text-[#ec4899]"; bgClass = "bg-[#fce7f3]"; }

                let movieSection = '';
                if (item.type === 'weekend') {
                    movieSection = `
                        <div class="mt-6 p-4 rounded-lg bg-orange-50 border border-orange-100">
                            <div class="flex items-start gap-3">
                                <div class="p-2 bg-white rounded-full shadow-sm text-orange-400"><i data-lucide="film" class="w-5 h-5"></i></div>
                                <div>
                                    <div class="text-[10px] uppercase tracking-widest text-orange-400 font-bold mb-1">Weekly Movie</div>
                                    <h4 class="font-serif text-lg font-bold text-stone-700 mb-1">${item.movie}</h4>
                                    <p class="text-sm text-stone-600">${item.movieDesc}</p>
                                </div>
                            </div>
                        </div>
                    `;
                }

                modalBody.innerHTML = `
                    <div class="relative">
                        <div class="h-24 ${bgClass} w-full relative overflow-hidden">
                             <i data-lucide="${listIcons[item.type]}" class="absolute -bottom-4 -right-4 w-24 h-24 ${accentClass} opacity-20 transform rotate-12"></i>
                             <div class="absolute top-6 left-6">
                                <div class="font-sans text-xs font-bold tracking-widest text-stone-400 mb-1">${item.date} ${item.day}</div>
                                <div class="font-serif text-xl font-bold text-stone-700 tracking-wider">${typeLabels[item.type]}</div>
                             </div>
                        </div>
                        <div class="p-6 md:p-8">
                            <div class="text-center mb-8">
                                <i data-lucide="quote" class="w-6 h-6 mx-auto mb-3 ${accentClass} opacity-60"></i>
                                <h3 class="font-serif text-xl md:text-2xl font-bold text-stone-700 leading-relaxed text-balance">${item.quote}</h3>
                            </div>
                            <div class="space-y-6">
                                <div class="flex gap-4">
                                    <div class="flex-shrink-0 mt-1">
                                        <div class="w-8 h-8 rounded-full ${bgClass} flex items-center justify-center ${accentClass}"><i data-lucide="zap" class="w-4 h-4"></i></div>
                                    </div>
                                    <div><h4 class="text-xs font-bold text-stone-400 uppercase tracking-widest mb-1">ä»Šæ—¥ç·´ç¿’</h4><p class="text-stone-700 leading-relaxed">${item.action}</p></div>
                                </div>
                                <div class="flex gap-4">
                                    <div class="flex-shrink-0 mt-1">
                                        <div class="w-8 h-8 rounded-full ${bgClass} flex items-center justify-center ${accentClass}"><i data-lucide="brain-circuit" class="w-4 h-4"></i></div>
                                    </div>
                                    <div><h4 class="text-xs font-bold text-stone-400 uppercase tracking-widest mb-1">è¦ºå¯Ÿæ™‚åˆ»</h4><p class="text-stone-700 leading-relaxed">${item.reflection}</p></div>
                                </div>
                            </div>
                            ${movieSection}
                            <button onclick="window.copyPageUrl(this, ${index})" class="w-full mt-8 py-3 rounded-lg border border-stone-200 text-stone-500 text-sm font-medium hover:bg-stone-50 transition-colors flex items-center justify-center gap-2 group"><i data-lucide="share-2" class="w-4 h-4 group-hover:scale-110 transition-transform"></i> åˆ†äº«ä»Šæ—¥ç·´ç¿’</button>
                            
                            <div class="mt-10 pt-6 border-t border-stone-100 text-center">
                                <p class="font-serif text-stone-500 font-bold tracking-[0.2em] mb-3">æ„›çš„æ±ºå®šå­¸</p>
                                <a href="https://line.me/ti/g2/QdcpjzvhMBkwRsceEkFdyP97e-fNqA8Pn_9G2w?utm_source=invitation&utm_medium=link_copy&utm_campaign=default" target="_blank" class="block text-stone-500 text-sm mb-4 hover:text-[#d4a373] transition-colors">ä¾† LuvBar ç¤¾ç¾¤ä¸€èµ·åˆ†äº«èˆ‡è¨è«– <span class="animate-bounce inline-block">ğŸ‘ˆ</span></a>
                                <a href="https://www.instagram.com/belovedroad.tw/" target="_blank" class="inline-flex items-center justify-center gap-2 text-stone-600 font-bold tracking-wider border-b border-stone-400 pb-1 hover:text-[#d4a373] hover:border-[#d4a373] transition-all">
                                    <span class="text-sm">è¿½è¹¤</span>
                                    <i data-lucide="instagram" class="w-4 h-4"></i>
                                    <span>@belovedroad.tw</span>
                                </a>
                            </div>
                        </div>
                    </div>
                `;
                overlay.classList.remove('hidden'); void overlay.offsetWidth; overlay.classList.remove('opacity-0'); modalContent.classList.remove('scale-95', 'opacity-0'); modalContent.classList.add('scale-100'); document.body.style.overflow = 'hidden';
                if(window.lucide) lucide.createIcons();
            };
            lucide.createIcons();
        });
    </script>
</body>
</html>
